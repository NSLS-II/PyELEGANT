E_MeV: 3000.0  # REQUIRED

input_LTE: # REQUIRED
  filepath: 'CLSmod23pm_20200123T160920_moga_prod_v1_002708.lte'  # REQUIRED

report_paragraphs: {}

lattice_props:
  use_beamline_cell: 'CELL'  # REQUIRED
  use_beamline_ring: &use_beamline_ring 'RING' # REQUIRED

  twiss_plot_opts: # REQUIRED
    one_period:
    - {print_scalars: [], right_margin_adj: 0.85}
    - &zoom_in {print_scalars: [], right_margin_adj: 0.85, slim: [0, 9],
      disp_elem_names: {bends: True, quads: True, sexts: True, font_size: 8,
        extra_dy_frac: 0.05}}
    - <<: *zoom_in
      slim: [4, 16]
    - <<: *zoom_in
      slim: [14, 23]

  twiss_plot_captions: # REQUIRED
    one_period:
    - 'Twiss functions for 2 cells (1 super-period).'
    - 'Twiss functions $(0 \le s \le 9)$.'
    - 'Twiss functions $(4 \le s \le 16)$.'
    - 'Twiss functions $(14 \le s \le 23)$.'

nonlin:
  include:  # REQUIRED
    fmap_xy: True  # On-Momentum Frequency Map
    fmap_px: True # Off-Momentum Frequency Map
    cmap_xy: True # On-Momentum Chaos Map
    cmap_px: True # Off-Momentum Chaos Map
    tswa: True # Tune Shift with Amplitude
    nonlin_chrom: True # Nonlinear Chromaticity

  # Common Options
  use_beamline: *use_beamline_ring
  N_KICKS: {KQUAD: 40, KSEXT: 8, CSBEND: 12} # REQUIRED

  # Common parallel options (can be overwritten in the options block
  # for each specific calculation type):
  common_remote_opts: # REQUIRED
    ntasks: 80  # REQUIRED

  # List of 2-D x-y grid specs for fmap & cmap calculations:
  xy_grids:
    xy1: &map_xy1
      xmin: -0.008
      xmax: 0.008
      ymin: 0.0
      ymax: 0.002
      nx: 201
      ny: 201
    xyTest:
      <<: *map_xy1
      nx: 21
      ny: 21

  # List of 2-D delta-x grid specs for fmap & cmap calculations:
  px_grids:
    px1: &map_px1
      delta_min: -0.05
      delta_max: 0.05
      xmin: -0.008
      xmax: 0.008
      ndelta: 201
      nx: 201
    pxTest:
      <<: *map_px1
      ndelta: 21
      nx: 21

  # Options specific only for on-momentum frequency map calculation
  fmap_xy_calc_opts:
    grid_name: 'xyTest'
    n_turns: 1024

  # Options specific only for off-momentum frequency map calculation
  fmap_px_calc_opts:
    grid_name: 'pxTest'
    n_turns: 1024

  # Options specific only for on-momentum chaos map calculation
  cmap_xy_calc_opts:
    grid_name: 'xyTest'
    n_turns: 128

  # Options specific only for off-momentum chaos map calculation
  cmap_px_calc_opts:
    grid_name: 'pxTest'
    n_turns: 128

  # List of 1-D grid specs for tune-shift-with-amplitude calculation:
  tswa_grids:
    xy1:
      abs_xmax: 0.001
      nx: 50
      abs_ymax: 0.0005
      ny: 50
  # Options specific only for tune-shift-with-amplitude calculation
  tswa_calc_opts:
    grid_name: 'xy1'
    n_turns: 1024
    remote_opts:
      time: '7:00'

  # List of 1-D grid specs for nonlinear chromaticity calculation:
  nonlin_chrom_grids:
    p1:
      delta_min: -0.04
      delta_max: 0.03
      ndelta: 100
  # Options specific only for nonlinear chromaticity calculation
  nonlin_chrom_calc_opts:
    grid_name: 'p1'
    n_turns: 1024
    remote_opts:
      time: '7:00'
